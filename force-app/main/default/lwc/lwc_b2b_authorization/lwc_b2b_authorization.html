<!--
  @description       : 
  @author            : ChangeMeIn@UserSettingsUnder.SFDoc
  @group             : 
  @last modified on  : 03-01-2021
  @last modified by  : ChangeMeIn@UserSettingsUnder.SFDoc
  Modifications Log 
  Ver   Date         Author                               Modification
  1.0   02-22-2021   ChangeMeIn@UserSettingsUnder.SFDoc   Initial Version
-->
<template>
    <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open modalFullScreen" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1">
        <template if:true={spinner}>
            <lightning-spinner alternative-text={label.Loading} size="medium"></lightning-spinner>
        </template>
        <div class="slds-modal__container">
            <c-lwc_b2b_process-header   
                has-back-button="true" 
                headerlabel={labelAuthorization} 
                onhandleback={sendToLanding}  
                has-discard-button={hasDiscardButton} 
                steps={steps} >
            </c-lwc_b2b_process-header>

            <div class="slds-modal__content" id="modal-content-id-1">
                <div class="slds-grid__content">
                    <div class="container_lastStep">  
                        <div class="slds-text-title">{label.VerifyBeforeAuth}</div>
                        <article class="slds-card">
                            <header class="slds-card__header">
                                <div class="slds-card__header-title">
                                    <span>{label.UserGroupProfileSummary}</span>
                                </div>
                            </header>
                            <div class="slds-card__body">
                                <div class="source"> 
                                    <div class="slds-card__header-title">
                                        <span>{label.sourceandRecepientAccounts}</span>
                                        <div class="line-title"></div>
                                    </div>
                                    <div class="slds-card__body">
                                        <div class="slds-grid">
                                            <div class="col title">{label.PAY_Summary_from}</div>
                                            <div class="col title">{label.PAY_Summary_To}</div>
                                        </div>
                                        <div class="slds-grid">
                                            <div class="col">
                                                <div class="subtitle">{label.orderingHolder}</div>
                                                <div class="text">{paymentData.sourceAccountHolder}</div>
                                            </div>
                                            <div class="col">
                                                <div class="subtitle">{label.Beneficiary}</div>
                                                <div class="text">{paymentData.beneficiaryAccountHolder}</div>
                                            </div>
                                        </div>
                                        <div class="slds-grid">
                                            <div class="col">
                                                <div class="subtitle">{label.orderingBank}</div>
                                                <div class="text">{paymentData.sourceBank}</div>
                                            </div>
                                            <div class="col">
                                                <div class="subtitle">{label.beneficiaryBank}</div>
                                                <div class="text">{paymentData.beneficiaryBank}</div>
                                            </div>
                                        </div>
                                        <div class="slds-grid">
                                            <div class="col">
                                                <div class="subtitle">{label.orderingAccount}</div>
                                                <div class="text">{paymentData.sourceAccount}</div>
                                            </div>
                                            <div class="col">
                                                <div class="subtitle">{label.beneficiaryAccount}</div>
                                                <div class="text">{paymentData.beneficiaryAccount}</div>
                                            </div>
                                        </div>
                                        <div class="slds-grid">
                                            <div class="col">
                                                <div class="subtitle">{label.Country}</div>
                                                <div class="text">{paymentData.parsedSourceCountry}</div>
                                            </div>
                                            <div class="col">
                                                <div class="subtitle">{label.Country}</div>
                                                <div class="text">{paymentData.parsedDestinationCountry}</div>
                                            </div>
                                        </div>
                                        <div class="slds-grid">
                                            <div class="col">
                                                <div class="subtitle">{label.Corporate}</div>
                                                <div class="text">{paymentData.sourceAlias}</div>
                                            </div>
                                            <div class="col">
                                                <div class="subtitle">{label.taxIdDocPassport}</div>
                                                <div class="text">{paymentData.beneficiarySwiftCode}</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="source"> 
                                    <div class="slds-card__header-title">
                                        <span>{label.paymentInformation}</span>
                                        <div class="line-title"></div>
                                    </div>
                                    <div class="slds-card__body">
                                        <div class="slds-grid">
                                            <div class="col">
                                                <div class="subtitle">{label.PAY_ProcessDate}</div>
                                                <div class="text">{paymentData.valueDate}</div>
                                            </div>
                                            <div class="col">
                                                <div class="subtitle">{label.transferMethod}</div>
                                                <div class="text">{paymentData.parsedPaymentMethod}</div>
                                            </div>
                                        </div>
                                        <div class="slds-grid">
                                            <div class="col">
                                                <div class="subtitle">{label.ClientReference}</div>
                                                <div class="text">{paymentData.clientReference}</div>
                                            </div>
                                            <div class="col">
                                                <div class="subtitle">{label.PaymentID}</div>
                                                <div class="text">{paymentData.paymentId}</div>
                                            </div>
                                        </div>
                                        <div class="slds-grid">
                                            <div class="col">
                                                <div class="subtitle">{label.PaymentReference}</div>
                                                <div class="text">{paymentData.subject}</div>
                                            </div>
                                            <div class="col">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <template if:true={isPaymentAmountNotUndefined}>
                                    <div class="amount">
                                        <div class="slds-card__header-title">
                                            <template if:true={isCibAndCurrenciesNotEquals}>
                                                <span>{label.amountAndFees}</span>
                                                <div class="line-title"></div>
                                            </template>
                                            <template if:false={isCibAndCurrenciesNotEquals}>
                                                <span>{label.amount}</span>
                                                <div class="line-title"></div>
                                            </template>
                                        </div>
                                        <template if:true={isCibFalse}>
                                            <div class="slds-card__body">
                                                <div class="slds-grid">
                                                    <div class="col title">{label.amount}</div>
                                        		    <template if:true={isPaymentDataAmountReceiveNotEmpty}>
                                                            <c-lwc_display-amount data-id="amountReceive"
                                                                onchange={handleConfirm}    
                                                                amount={paymentData.amountReceive} 
                                                                decimalclass="title" 
                                                                wholeclass="title" 
                                                                currencyclass="title"  
                                                                currency={paymentData.beneficiaryCurrency} 
                                                                numberformat={userData.convertedCurrency}
                                                                output-string={paymentAmountString}>
                                                            </c-lwc_display-amount>
                                                    </template>	
                                                    <template if:false={isPaymentDataAmountReceiveNotEmpty}>
                                                            <c-lwc_display-amount data-id="amountReceive" 
                                                                onchange={handleConfirm}   
                                                                amount={paymentData.amount} 
                                                                decimalclass="title" 
                                                                wholeclass="title" 
                                                                currencyclass="title"     
                                                                currency={paymentData.beneficiaryCurrency} 
                                                                numberformat={userData.convertedCurrency}
                                                                output-string={paymentAmountString}>
                                                            </c-lwc_display-amount>
                                                    </template>
                                                </div>
                                        		<template if:true={isCurrenciesNotEquals}>
                                                    <div class="slds-grid">
                                                        <div class="col">
                                                            <div class="tooltip__content">
                                                                <template if:true={isSignatoryAndLastSign}>
                                                                    <div class="text">{label.exchangeRate}</div>
                                                                </template>
                                                                <template if:false={isSignatoryAndLastSign}>
                                                                	<div class="text">{label.indicativeExchangeRate}</div>
                                                                </template>
                                                                <div class="tooltip tooltip_center__top">
                                                                    <button class="slds-button slds-button_icon" aria-describedby="help" aria-disabled="true">
                                                                        <span class="slds-button__icon icon icon-information"></span>
                                                                        <span class="slds-assistive-text">{label.help}</span>
                                                                    </button>
                                                                    <div class="slds-popover slds-popover_tooltip slds-nubbin_bottom" role="tooltip" id="help">
                                                                        <div class="slds-popover__body">
                                                                            <div class="title">
                                                                                {label.exchangeRate}
                                                                            </div>
                                                                            <div class="line"></div>
                                                                            <div class="text">
                                                                                {label.B2B_PaymentSummaryValue}
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>  
                                                            </div>
                                                        </div>
                                                        <div class="col">
                                                            <c-lwc_display-amount data-id="nominalDetail" 
                                                                amount={paymentData.operationNominalFxDetails.customerExchangeRate} 
                                                                decimalclass="number" 
                                                                wholeclass="number" 
                                                                output-string={exchangeRateString}
                                                                currency={label.EUR} 
                                                                numberformat={userData.convertedCurrency}>
                                                            </c-lwc_display-amount> / {label.GBP}
                                                        </div>
                                                    </div>
                                                    <div class="slds-grid">
                                                        <div class="col">
                                                            <div class="text">
                                                                {label.amountIn}&nbsp;<span>{paymentData.sourceCurrency}</span>
                                                            </div>
                                                        </div>
                                                        <div class="col">
                                                            <c-lwc_display-amount data-id="amountSend" 
                                                                amount={paymentData.amountSend} 
                                                                decimalclass="number" 
                                                                wholeclass="number" 
                                                                currency={paymentData.sourceCurrency} 
                                                                numberformat={userData.numberFormat}>
                                                            </c-lwc_display-amount> 
                                                        </div>
                                                    </div>
                                                </template>
                                                <div class="slds-grid">
                                                    <div class="col">
                                                        <div class="tooltip__content">
                                                            <div class="text">{label.transferFee}</div>
                                                            <div class="tooltip tooltip_center__top">
                                                                <button class="slds-button slds-button_icon" aria-describedby="help" aria-disabled="true">
                                                                    <span class="slds-button__icon icon icon-information"></span>
                                                                    <span class="slds-assistive-text">{label.help}</span>
                                                                </button>
                                                                <div class="slds-popover slds-popover_tooltip slds-nubbin_bottom" role="tooltip" id="help1">
                                                                    <div class="slds-popover__body">
                                                                        <div class="title">
                                                                            {label.transferFee}
                                                                        </div>
                                                                        <div class="line"></div>
                                                                        <div class="text">
                                                                            {label.B2B_PaymentSummary3}
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>  
                                                        </div>
                                                    </div>
                                                    <div class="col">
                                                        <c-lwc_display-amount data-id="amountFees" 
                                                            amount={paymentData.fees} 
                                                            decimalclass="number" 
                                                            wholeclass="number" 
                                                            currency={paymentData.feesCurrency} 
                                                            numberformat={userData.numberFormat}
                                                            output-string = "{feesString}" >
                                                        </c-lwc_display-amount> 
                                                    </div>
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                </template>
                            </div>
                            <footer class={classCardFooter}>
                                <template if:true={isPaymentDataTotalAmountNotEmpty}>
                                    <div class="slds-grid">
                                        <div class="col">
                                            <div class="title-text">{label.AmountToAuth}</div>
                                        </div>
                                        <div class="col finalNumber">
                                            <c-lwc_display-amount data-id="amountToAuth" 
                                                amount={paymentData.totalAmount} 
                                                decimalclass="title-number" 
                                                wholeclass="title-number" 
                                                currency={paymentData.sourceCurrency} 
                                                numberformat={userData.numberFormat}
                                                output-string = "{debitAmountString}"
                                            ></c-lwc_display-amount>                                             
                                        </div>
                                    </div>
                                </template>
                                    <template if:true={isSignatoryAndLastSignAndCurrenciesNotEquals}>
                                            <c-lwc_count-down  minutes="5" 
                                                spinner={spinnerCountDown}
                                                f-x-action={reloadFX}
                                                update="true" 
                                                expired-f-x={expiredFX}>
                                            </c-lwc_count-down>
                                    </template>
                            </footer> 
                        </article>
                        <template if:true={isExpiredFX}>
                            <c-lwc_waiting-authorization 
                                headerlabel
                                expired={expiredFX}
                                spinner={spinnerVerificationCode}
                                onresendaction={sendOTP_Strategic} 
                                error-o-t-p ={errorOTP}>
                            </c-lwc_waiting-authorization >
                        </template>

                        <button  onclick={handleConfirm}>Confirmar</button>
                    </div>
                </div>
            </div>
        </div>
        <c-lwc_b2b_toast data-id="errorToast" reload={reload}></c-lwc_b2b_toast>
    </section>
    <div class="slds-backdrop slds-backdrop_open"></div>
</template>